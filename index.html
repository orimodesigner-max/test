<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Location-based AR Debug</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <style>
        /* 距離を表示するデバッグ窓のデザイン */
        #debug {
            position: fixed;
            z-index: 10000;
            background-color: rgba(0, 0, 0, 0.8); /* 背景を黒く */
            color: yellow; /* 文字を黄色く */
            font-size: 24px; /* 文字を大きく */
            font-weight: bold;
            padding: 20px;
            top: 10px;
            left: 10px;
            border: 2px solid white;
            display: block;
        }
    </style>
</head>

<body style="margin: 0; overflow: hidden;">
    <div id="debug">GPS取得中...</div>

    <a-scene
        vr-mode-ui="enabled: false"
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false;"
    >
        <a-box
            id="target-box"
            material="color: red"
            gps-entity-place="latitude: 35.701820413676195; longitude: 139.8251889595972;"
            scale="30 30 30"
            look-at="[gps-camera]"
        ></a-box>

        <a-camera gps-camera="minDistance: 0; maxDistance: 1000; gpsMinDistance: 5;" rotation-reader></a-camera>
    </a-scene>

    <script>
        window.addEventListener('load', () => {
            const debugDiv = document.getElementById('debug');
            const target = document.getElementById('target-box');

            // 距離が更新されたら画面に表示する処理
            target.addEventListener('gps-entity-place-update-position', (event) => {
                const distance = Math.round(event.detail.distance);
                debugDiv.textContent = `あと ${distance}m`;
                
                // 距離に応じて色を変える演出（近づいたら青になる）
                if(distance < 50) {
                    target.setAttribute('material', 'color: blue');
                } else {
                    target.setAttribute('material', 'color: red');
                }
            });
        });
    </script>
</body>
</html>